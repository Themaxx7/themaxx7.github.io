<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Mapa mental — Normas eléctricas internacionales (Alejandro Elgueta)</title>
  <style>
    :root{
      --bg:#f6f7fb;
      --panel:#ffffff;
      --panel2:#fbfbff;
      --glass:rgba(0,0,0,.02);
      --line:rgba(15,23,42,.10);
      --muted:#475569;
      --text:#0f172a;

      --neon:#16a34a;
      --cyan:#0891b2;
      --pink:#db2777;
      --danger:#dc2626;

      --shadow:0 18px 50px rgba(2,6,23,.10);
      --shadow2:0 10px 28px rgba(2,6,23,.08);
      --r:18px;
      --r2:14px;
      --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      color:var(--text);
      font-family: system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Cantarell,Noto Sans,Arial;
      background:
        radial-gradient(1200px 600px at 8% -10%, rgba(22,163,74,.12), transparent 55%),
        radial-gradient(900px 550px at 92% 0%, rgba(8,145,178,.10), transparent 55%),
        radial-gradient(900px 650px at 70% 110%, rgba(219,39,119,.08), transparent 60%),
        var(--bg);
      overflow-x:hidden;
    }

    /* Top signature bar */
    .topSig{
      position: sticky;
      top: 0;
      z-index: 80;
      border-bottom: 1px solid var(--line);
      background: rgba(255,255,255,.88);
      backdrop-filter: blur(10px);
    }
    .topSig .wrap{
      max-width: 1400px;
      margin: 0 auto;
      padding: 12px 16px;
      display:flex;
      align-items: center;
      justify-content: space-between;
      gap: 14px;
    }
    .who{
      display:flex;
      flex-direction: column;
      gap: 2px;
      min-width: 0;
    }
    .who .name{
      font-weight: 950;
      letter-spacing:.25px;
      font-size: 14px;
      margin:0;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }
    .who .role{
      margin:0;
      color: var(--muted);
      font-size: 12.5px;
      line-height: 1.3;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }
    .who .role2{
      margin:0;
      color: rgba(15,23,42,.72);
      font-size: 12px;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }
    .rightPills{
      display:flex;
      gap: 8px;
      flex-wrap: wrap;
      justify-content: flex-end;
    }
    .pill{
      font-size: 11px;
      border: 1px solid var(--line);
      background: rgba(255,255,255,.7);
      color: rgba(15,23,42,.78);
      padding: 5px 10px;
      border-radius: 999px;
      user-select: none;
      white-space: nowrap;
    }
    .pill.neon{ border-color: rgba(22,163,74,.35); box-shadow: 0 0 0 3px rgba(22,163,74,.08) inset; }
    .pill.cyan{ border-color: rgba(8,145,178,.35); box-shadow: 0 0 0 3px rgba(8,145,178,.08) inset; }

    .app{
      display:grid;
      grid-template-columns: 330px 1fr;
      min-height: calc(100vh - 0px);
    }

    .sidebar{
      border-right:1px solid var(--line);
      background: linear-gradient(180deg, rgba(255,255,255,.92), rgba(255,255,255,.80));
      backdrop-filter: blur(10px);
      padding:16px;
      height: calc(100vh - 54px);
      overflow:auto;
      position: sticky;
      top: 54px; /* below topSig */
    }

    .brand{
      padding:12px 12px 14px 12px;
      border:1px solid var(--line);
      background: linear-gradient(180deg, rgba(255,255,255,1), rgba(255,255,255,.85));
      border-radius: var(--r);
      box-shadow: var(--shadow2);
      position:relative;
      overflow:hidden;
    }
    .brand:after{
      content:"";
      position:absolute;
      inset:-30% -20%;
      background: linear-gradient(90deg, transparent, rgba(22,163,74,.18), rgba(8,145,178,.14), rgba(219,39,119,.12), transparent);
      transform: rotate(10deg);
      opacity:.9;
    }
    .brand .inner{ position:relative; z-index:1; }
    .brand h1{
      margin:0 0 6px 0;
      font-size: 14px;
      font-weight: 950;
      letter-spacing:.2px;
    }
    .brand .sub{
      margin:0;
      color: var(--muted);
      font-size: 12.5px;
      line-height:1.35;
    }

    .search{
      margin: 14px 0 12px 0;
      display:grid;
      gap:10px;
    }
    input[type="search"]{
      width:100%;
      padding:12px 12px;
      border-radius: 14px;
      border:1px solid var(--line);
      background: rgba(255,255,255,.9);
      color: var(--text);
      outline:none;
      font-size:14px;
      box-shadow: 0 6px 16px rgba(2,6,23,.04);
    }
    input[type="search"]:focus{
      border-color: rgba(22,163,74,.45);
      box-shadow: 0 0 0 3px rgba(22,163,74,.12);
    }

    .btnrow{ display:flex; gap:10px; flex-wrap:wrap; }
    .btn{
      padding:10px 12px;
      border-radius:14px;
      border:1px solid var(--line);
      background: rgba(255,255,255,.85);
      color: var(--text);
      cursor:pointer;
      font-size: 12px;
      transition: transform .08s ease, border-color .12s ease;
      user-select:none;
      box-shadow: 0 6px 16px rgba(2,6,23,.04);
    }
    .btn:hover{ border-color: rgba(22,163,74,.35); }
    .btn:active{ transform: translateY(1px); }
    .btn.danger:hover{ border-color: rgba(220,38,38,.45); }

    .sectionTitle{
      margin: 14px 6px 8px;
      color: rgba(15,23,42,.70);
      font-size: 11px;
      font-weight: 950;
      letter-spacing:.28px;
      text-transform: uppercase;
      display:flex;
      align-items:center;
      gap:10px;
    }
    .sectionTitle:before{
      content:"";
      height:1px;
      flex:1;
      background: linear-gradient(90deg, rgba(22,163,74,.35), rgba(8,145,178,.25), rgba(219,39,119,.18), transparent);
    }

    .catlist{ display:grid; gap:8px; padding: 0 2px 10px 2px; }
    .cat{
      padding:10px 10px;
      border-radius: 16px;
      border:1px solid var(--line);
      background: rgba(255,255,255,.88);
      cursor:pointer;
      display:flex;
      align-items:center;
      gap:10px;
      transition: border-color .12s ease, transform .08s ease;
      box-shadow: 0 6px 16px rgba(2,6,23,.04);
    }
    .cat:hover{ border-color: rgba(22,163,74,.32); transform: translateY(-1px); }
    .cat.active{ border-color: rgba(22,163,74,.55); background: rgba(22,163,74,.07); }
    .dot{
      width: 10px; height: 10px;
      border-radius: 999px;
      background: rgba(22,163,74,.92);
      box-shadow: 0 0 0 5px rgba(22,163,74,.12);
    }
    .cat .meta{ display:flex; flex-direction:column; gap:2px; min-width:0; }
    .cat .name{ font-weight: 900; font-size: 12.8px; white-space:nowrap; overflow:hidden; text-overflow:ellipsis; margin:0; }
    .cat .count{ font-size: 12px; color: var(--muted); }

    .note{
      margin-top: 14px;
      padding: 12px 12px;
      border-radius: var(--r);
      border: 1px solid var(--line);
      background: rgba(255,255,255,.9);
      box-shadow: 0 6px 16px rgba(2,6,23,.04);
      color: var(--muted);
      font-size: 12.5px;
      line-height: 1.35;
    }

    .main{
      padding: 18px;
      max-width: 1400px;
    }

    .topbar{
      display:flex;
      align-items:flex-start;
      justify-content: space-between;
      gap: 14px;
      margin-bottom: 12px;
    }
    .title h2{
      margin:0;
      font-size: 18px;
      font-weight: 950;
      letter-spacing:.2px;
    }
    .title p{
      margin: 6px 0 0 0;
      color: var(--muted);
      font-size: 13px;
      line-height: 1.35;
      max-width: 900px;
    }
    .chips{
      display:flex;
      gap:8px;
      flex-wrap:wrap;
      justify-content:flex-end;
    }
    .chip{
      border: 1px solid var(--line);
      background: rgba(255,255,255,.86);
      color: rgba(15,23,42,.78);
      padding: 6px 10px;
      border-radius: 999px;
      font-size: 12px;
      cursor:pointer;
      user-select:none;
      transition: border-color .12s ease;
      box-shadow: 0 6px 16px rgba(2,6,23,.04);
    }
    .chip:hover{ border-color: rgba(8,145,178,.40); }

    .grid{
      display:grid;
      grid-template-columns: repeat(3, minmax(0, 1fr));
      gap: 12px;
    }
    @media (max-width: 1100px){ .grid{ grid-template-columns: repeat(2, minmax(0, 1fr)); } }
    @media (max-width: 760px){
      .app{ grid-template-columns: 1fr; }
      .sidebar{ position:relative; top:0; height:auto; }
      .grid{ grid-template-columns: 1fr; }
      .topSig .wrap{ flex-direction: column; align-items:flex-start; }
      .rightPills{ justify-content:flex-start; }
    }

    .card{
      border:1px solid var(--line);
      background: linear-gradient(180deg, rgba(255,255,255,1), rgba(255,255,255,.92));
      border-radius: var(--r);
      padding: 12px;
      box-shadow: var(--shadow2);
      cursor:pointer;
      position:relative;
      overflow:hidden;
      min-height: 120px;
      transition: border-color .12s ease, transform .08s ease;
    }
    .card:before{
      content:"";
      position:absolute;
      left:-1px; right:-1px; top:-1px;
      height: 3px;
      background: linear-gradient(90deg, rgba(22,163,74,.55), rgba(8,145,178,.35), rgba(219,39,119,.25), transparent);
      opacity:.95;
    }
    .card:hover{ border-color: rgba(22,163,74,.38); transform: translateY(-1px); }
    .code{
      font-family: var(--mono);
      font-weight: 950;
      letter-spacing:.4px;
      font-size: 14px;
      margin-bottom: 6px;
      color: rgba(15,23,42,.92);
    }
    .name{
      font-weight: 900;
      font-size: 13px;
      margin-bottom: 6px;
      color: rgba(15,23,42,.92);
    }
    .desc{
      color: var(--muted);
      font-size: 12.8px;
      line-height: 1.35;
    }
    .tagrow{ display:flex; gap:6px; flex-wrap:wrap; margin-top:10px; }
    .tag{
      font-size: 11px;
      font-family: var(--mono);
      border: 1px solid rgba(15,23,42,.12);
      background: rgba(2,6,23,.03);
      padding: 3px 8px;
      border-radius: 999px;
      color: rgba(15,23,42,.72);
    }

    /* Modal */
    .overlay{
      position:fixed;
      inset:0;
      background: rgba(15,23,42,.45);
      display:none;
      align-items:center;
      justify-content:center;
      padding: 16px;
      z-index: 90;
    }
    .overlay.show{ display:flex; }
    .modal{
      width: min(980px, 100%);
      border-radius: 20px;
      border: 1px solid rgba(15,23,42,.12);
      background: rgba(255,255,255,.98);
      box-shadow: var(--shadow);
      overflow:hidden;
    }
    .modalHeader{
      padding: 14px 14px 10px 14px;
      border-bottom: 1px solid rgba(15,23,42,.10);
      display:flex;
      align-items:flex-start;
      justify-content:space-between;
      gap: 12px;
      position: relative;
    }
    .modalHeader:after{
      content:"";
      position:absolute;
      left:0; right:0; bottom:0;
      height:3px;
      background: linear-gradient(90deg, rgba(22,163,74,.55), rgba(8,145,178,.35), rgba(219,39,119,.25), transparent);
      opacity:.95;
    }
    .modalHeader .left{ min-width:0; }
    .modalHeader .mcode{ font-family: var(--mono); font-weight: 950; font-size: 16px; letter-spacing:.35px; margin: 0 0 4px 0; }
    .modalHeader .mname{ margin: 0 0 6px 0; font-weight: 950; font-size: 13px; color: rgba(15,23,42,.88); }
    .badge{
      display:inline-flex;
      align-items:center;
      gap: 8px;
      padding: 6px 10px;
      border-radius: 999px;
      border: 1px solid rgba(15,23,42,.12);
      background: rgba(2,6,23,.02);
      font-size: 12px;
      color: var(--muted);
    }
    .x{
      width: 38px;
      height: 38px;
      border-radius: 14px;
      border: 1px solid rgba(15,23,42,.12);
      background: rgba(2,6,23,.02);
      color: var(--text);
      cursor:pointer;
      display:grid;
      place-items:center;
      font-size: 18px;
      line-height: 1;
    }
    .x:hover{ border-color: rgba(220,38,38,.45); }

    .modalBody{
      padding: 14px;
      display:grid;
      grid-template-columns: 1.25fr .75fr;
      gap: 12px;
    }
    @media (max-width: 900px){ .modalBody{ grid-template-columns: 1fr; } }
    .box{
      border: 1px solid rgba(15,23,42,.10);
      border-radius: 18px;
      padding: 12px;
      background: rgba(2,6,23,.02);
    }
    .box h3{
      margin:0 0 8px 0;
      font-size: 11px;
      text-transform: uppercase;
      letter-spacing: .28px;
      color: rgba(15,23,42,.78);
      font-weight: 950;
    }
    .box p{
      margin:0;
      color: var(--muted);
      font-size: 13px;
      line-height: 1.45;
    }
    .actions{ display:flex; gap:10px; flex-wrap:wrap; margin-top: 10px; }
    .action{
      padding: 10px 12px;
      border-radius: 14px;
      border: 1px solid rgba(15,23,42,.12);
      background: rgba(255,255,255,.92);
      color: var(--text);
      cursor:pointer;
      font-size: 12px;
      user-select:none;
      transition: border-color .12s ease, transform .08s ease;
      box-shadow: 0 6px 16px rgba(2,6,23,.04);
    }
    .action:hover{ border-color: rgba(22,163,74,.38); }
    .action:active{ transform: translateY(1px); }
    .action.blue:hover{ border-color: rgba(8,145,178,.40); }
    .action.pink:hover{ border-color: rgba(219,39,119,.35); }

    /* Context menu */
    .ctx{
      position:fixed;
      display:none;
      z-index: 95;
      width: 260px;
      border-radius: 16px;
      border: 1px solid rgba(15,23,42,.14);
      background: rgba(255,255,255,.98);
      box-shadow: var(--shadow);
      overflow:hidden;
    }
    .ctx.show{ display:block; }
    .ctx .item{
      padding: 10px 12px;
      cursor:pointer;
      font-size: 13px;
      border-bottom: 1px solid rgba(15,23,42,.08);
      display:flex;
      justify-content: space-between;
      gap: 10px;
      color: rgba(15,23,42,.92);
    }
    .ctx .item:last-child{ border-bottom:0; }
    .ctx .item:hover{ background: rgba(2,6,23,.03); }
    .kbd{ color: var(--muted); font-size: 12px; font-family: var(--mono); }

    /* Toast */
    .toast{
      position: fixed;
      left: 50%;
      bottom: 18px;
      transform: translateX(-50%);
      border: 1px solid rgba(15,23,42,.12);
      background: rgba(255,255,255,.95);
      backdrop-filter: blur(10px);
      border-radius: 999px;
      padding: 10px 14px;
      color: rgba(15,23,42,.86);
      font-size: 12.5px;
      box-shadow: var(--shadow);
      display:none;
      z-index: 99;
      gap: 10px;
      align-items: center;
    }
    .toast.show{ display:flex; }
    .toast .b{
      width: 8px; height: 8px; border-radius: 99px;
      background: var(--neon);
      box-shadow: 0 0 0 5px rgba(22,163,74,.12);
    }

    .empty{
      border: 1px dashed rgba(15,23,42,.20);
      border-radius: var(--r);
      padding: 14px;
      color: var(--muted);
      font-size: 13px;
      line-height: 1.35;
      background: rgba(255,255,255,.85);
      grid-column: 1/-1;
      box-shadow: 0 6px 16px rgba(2,6,23,.04);
    }
  </style>
</head>
<body>

<div class="topSig">
  <div class="wrap">
    <div class="who">
      <p class="name">Alejandro Elgueta Zarhi</p>
      <p class="role">Ingeniero en Electricidad | Ingeniero Civil Industrial</p>
      <p class="role2">ITO Senior Eléctrico en Fábrica · Chile</p>
    </div>
    <div class="rightPills">
      <span class="pill neon">Click: ventana</span>
      <span class="pill cyan">Click derecho: menú</span>
      <span class="pill">Base: 12-12-2025</span>
    </div>
  </div>
</div>

<div class="app">
  <aside class="sidebar">
    <div class="brand">
      <div class="inner">
        <h1>Mapa mental (desplegable) — Normas eléctricas internacionales</h1>
        <p class="sub">Hecho pa’ buscar rápido por familias y abrir fichas (sin humo).</p>
      </div>
    </div>

    <div class="search">
      <input id="search" type="search" placeholder="Buscar (ej: 61439, 60076, 60255, arc flash, cables)…">
      <div class="btnrow">
        <button class="btn" id="btnFav">Favoritos</button>
        <button class="btn" id="btnAll">Ver todo</button>
        <button class="btn danger" id="btnClearFav">Borrar favs</button>
      </div>
    </div>

    <div class="sectionTitle">Categorías</div>
    <div class="catlist" id="catlist"></div>

    <div class="note">
      Tip: Click normal abre la ficha. Click derecho abre el menú (copiar / buscar / favorito).<br/>
      Los favoritos se guardan en tu navegador (localStorage).
    </div>
  </aside>

  <main class="main">
    <div class="topbar">
      <div class="title">
        <h2 id="viewTitle">Todo</h2>
        <p id="viewSub">Mapa base por familias. Para informe: cita la edición/parte exacta de la norma que aplique.</p>
      </div>
      <div class="chips" id="chips"></div>
    </div>

    <div class="grid" id="grid"></div>
  </main>
</div>

<!-- Modal -->
<div class="overlay" id="overlay" aria-hidden="true">
  <div class="modal" role="dialog" aria-modal="true" aria-labelledby="mCode">
    <div class="modalHeader">
      <div class="left">
        <p class="mcode" id="mCode">—</p>
        <p class="mname" id="mName">—</p>
        <span class="badge"><span class="dot" style="width:8px;height:8px;box-shadow:none;"></span><span id="mCat">—</span></span>
      </div>
      <button class="x" id="mClose" title="Cerrar (Esc)">×</button>
    </div>
    <div class="modalBody">
      <div class="box">
        <h3>Qué es / para qué se usa</h3>
        <p id="mDesc">—</p>
        <div class="actions">
          <button class="action" id="aCopy">Copiar código</button>
          <button class="action blue" id="aSearch">Buscar en web</button>
          <button class="action pink" id="aFav">Favorito</button>
        </div>
      </div>
      <div class="box">
        <h3>Tags rápidos</h3>
        <div class="tagrow" id="mTags"></div>
        <div style="height:12px"></div>
        <h3>Firma</h3>
        <p style="color: var(--muted);">
          Alejandro Elgueta Zarhi<br/>
          Ingeniero en Electricidad | Ingeniero Civil Industrial<br/>
          ITO Senior Eléctrico en Fábrica
        </p>
      </div>
    </div>
  </div>
</div>

<!-- Context menu -->
<div class="ctx" id="ctx">
  <div class="item" data-act="open">Abrir ficha <span class="kbd">Enter</span></div>
  <div class="item" data-act="copy">Copiar código <span class="kbd">Ctrl/Cmd+C</span></div>
  <div class="item" data-act="search">Buscar en web <span class="kbd">S</span></div>
  <div class="item" data-act="fav">Favorito <span class="kbd">F</span></div>
</div>

<div class="toast" id="toast"><span class="b"></span><span id="toastTxt">Copiado</span></div>

<script>
const DB = {"categories": [{"category": "Organismos y marcos", "items": [{"key": "IEC", "code": "IEC", "name": "International Electrotechnical Commission", "desc": "Organismo internacional que publica normas eléctricas/electrónicas. Base en potencia, instalaciones, equipos, cables, compatibilidad electromagnética (EMC)."}, {"key": "IEEE", "code": "IEEE", "name": "Institute of Electrical and Electronics Engineers", "desc": "Estándares técnicos (potencia, protección, comunicaciones, cálculo, interoperabilidad). Muy usado en América."}, {"key": "ISOIEC", "code": "ISO/IEC", "name": "ISO + ISO/IEC", "desc": "Gestión, calidad, seguridad, laboratorios, etc. Cuando es conjunto ISO/IEC aplica fuerte en tecnologías de la información (TI)."}, {"key": "NFPA", "code": "NFPA", "name": "National Fire Protection Association", "desc": "Normas de seguridad y protección contra incendios. NFPA 70 (NEC) y NFPA 70E son claves."}, {"key": "ULCSA", "code": "UL / CSA", "name": "UL / CSA", "desc": "Normas/certificación de producto (especialmente mercado USA/Canadá)."}, {"key": "ANSI", "code": "ANSI", "name": "American National Standards Institute", "desc": "Marco de normalización USA; coordina estándares (muchos son IEEE/UL/otros)."}, {"key": "CENELEC", "code": "CENELEC EN", "name": "Normas europeas EN", "desc": "Armonización europea; muchas se basan en IEC con adopciones EN."}, {"key": "ITUETSI", "code": "ITU / ETSI", "name": "Telecom y comunicaciones", "desc": "Normas de telecomunicaciones (más TI/telecom que potencia)."}, {"key": "NEMA", "code": "NEMA", "name": "National Electrical Manufacturers Association", "desc": "Estándares de producto (closures, tableros). Muy usado con mercado USA."}]}, {"category": "Instalaciones y tableros BT", "items": [{"key": "IEC60364", "code": "IEC 60364", "name": "Instalaciones eléctricas de baja tensión (BT)", "desc": "Diseño/ejecución/seguridad de instalaciones de baja tensión (BT – Baja Tensión)."}, {"key": "NFPA70", "code": "NFPA 70 (NEC)", "name": "National Electrical Code (NEC – Código Eléctrico Nacional)", "desc": "Código de instalaciones eléctricas USA (requisitos constructivos/seguridad)."}, {"key": "IEC60204", "code": "IEC 60204-1", "name": "Equipos eléctricos de máquinas", "desc": "Seguridad eléctrica en maquinaria industrial: diseño/ensayos del equipo eléctrico de máquinas."}, {"key": "IEC61439", "code": "IEC 61439", "name": "Tableros BT (conjuntos de aparamenta)", "desc": "Requisitos de diseño/ensayos para tableros BT (switchboards, centros de control de motores – CCM)."}, {"key": "IEC60947", "code": "IEC 60947", "name": "Aparamenta BT", "desc": "Interruptores, contactores, protecciones y accesorios (familia)."}, {"key": "IEC60529", "code": "IEC 60529", "name": "Grados de protección IP", "desc": "Clasificación IP (Ingress Protection – Protección contra ingreso): polvo/agua."}, {"key": "IEC60664", "code": "IEC 60664", "name": "Coordinación de aislamiento", "desc": "Distancias en aire/superficie (clearance/creepage) y selección frente a sobretensiones."}]}, {"category": "Seguridad eléctrica (personas)", "items": [{"key": "NFPA70E", "code": "NFPA 70E", "name": "Seguridad eléctrica en el trabajo", "desc": "Arc flash (arco eléctrico), EPP (Equipo de Protección Personal), límites de aproximación y prácticas seguras."}, {"key": "IEEE1584", "code": "IEEE 1584", "name": "Cálculo de energía incidente por arco", "desc": "Método para estimar energía incidente (incident energy) y límites de arco eléctrico."}, {"key": "IEC61482", "code": "IEC 61482", "name": "Ropa de protección contra arco eléctrico", "desc": "Ensayos/criterios para vestimenta y EPP frente a arco eléctrico."}, {"key": "IEC50110", "code": "IEC 50110-1", "name": "Operación de instalaciones eléctricas", "desc": "Requisitos para operación/maniobras, procedimientos, roles y seguridad en operación."}, {"key": "ISO45001", "code": "ISO 45001", "name": "Gestión de seguridad y salud ocupacional (SST)", "desc": "Sistema de gestión de Seguridad y Salud en el Trabajo (SST). Aplica a procesos/SGI."}]}, {"category": "Equipos MT/AT (subestaciones, celdas, interruptores)", "items": [{"key": "IEC62271", "code": "IEC 62271", "name": "Aparamenta de alta tensión (AT)", "desc": "Familia para celdas, interruptores, GIS/AIS, ensayos, clasificación y requisitos."}, {"key": "IEEEC37", "code": "IEEE C37", "name": "Aparamenta MT/AT (familia)", "desc": "Familia C37 (USA): interruptores, control, pruebas, etc."}, {"key": "IEC60076", "code": "IEC 60076", "name": "Transformadores de potencia", "desc": "Serie para diseño/ensayos/ruido/temperatura/aceites (según parte aplicable)."}, {"key": "IEEEC57", "code": "IEEE C57", "name": "Transformadores (serie)", "desc": "Familia C57 (USA) para transformadores: ratings, ensayos, guías."}, {"key": "IEC60034", "code": "IEC 60034", "name": "Máquinas eléctricas rotativas", "desc": "Serie para motores y generadores: ratings, ensayos, desempeño y protección."}, {"key": "IEC60871", "code": "IEC 60871", "name": "Condensadores de potencia / bancos", "desc": "Requisitos y ensayos para condensadores y bancos de condensadores."}]}, {"category": "Protección, control y automatización", "items": [{"key": "IEC60255", "code": "IEC 60255", "name": "Relés de protección", "desc": "Requisitos/ensayos para relés de protección y equipos asociados."}, {"key": "IEC61850", "code": "IEC 61850", "name": "Automatización de subestaciones", "desc": "Modelos/servicios (GOOSE, MMS), ingeniería SCL y criterios de interoperabilidad."}, {"key": "IEEEC372", "code": "IEEE C37.2", "name": "Números de dispositivos (ANSI device numbers)", "desc": "Device numbers (ANSI) para funciones de protección/control (ej: 52, 87, 50/51, etc.)."}, {"key": "IEEEC37118", "code": "IEEE C37.118", "name": "Sincrofasores (PMU)", "desc": "Medición y comunicación de fasores sincronizados (PMU – Phasor Measurement Unit)."}, {"key": "IEEE1815", "code": "IEEE 1815 (DNP3)", "name": "Protocolo DNP3", "desc": "Protocolo SCADA para telecontrol (DNP3 – Distributed Network Protocol)."}]}, {"category": "Cables, conductores y fuego", "items": [{"key": "IEC60228", "code": "IEC 60228", "name": "Conductores de cables", "desc": "Clases de conductor y resistencias eléctricas del conductor."}, {"key": "IEC60502", "code": "IEC 60502", "name": "Cables de potencia (hasta 30 kV)", "desc": "Requisitos/ensayos de cables con aislamiento extruido (según parte/voltaje)."}, {"key": "IEC60840_62067", "code": "IEC 60840 / IEC 62067", "name": "Cables extruidos > 30 kV", "desc": "Requisitos y ensayos para cables de MT/AT con aislamiento extruido > 30 kV."}, {"key": "IEC60332", "code": "IEC 60332", "name": "Ensayos de propagación de llama", "desc": "Comportamiento al fuego de cables: propagación de llama (serie)."}, {"key": "IEC60754", "code": "IEC 60754", "name": "Gases halógenos", "desc": "Acidez/corrosividad de gases de combustión (halógenos)."}, {"key": "IEC61034", "code": "IEC 61034", "name": "Densidad de humo", "desc": "Ensayo de emisión/densidad de humo en combustión."}]}, {"category": "Compatibilidad electromagnética (EMC)", "items": [{"key": "IEC61000", "code": "IEC 61000", "name": "Compatibilidad electromagnética (EMC)", "desc": "Serie EMC (Electromagnetic Compatibility): emisiones, inmunidad y métodos de prueba."}, {"key": "CISPR", "code": "CISPR", "name": "Perturbaciones radioeléctricas", "desc": "Normas CISPR para emisiones/medición en radiofrecuencia."}, {"key": "IEC61326", "code": "IEC 61326", "name": "EMC para medición/industrial", "desc": "Requisitos EMC para equipos de medición, control y laboratorio."}]}, {"category": "Calidad de energía", "items": [{"key": "IEEE519", "code": "IEEE 519", "name": "Armónicos y límites", "desc": "Límites y prácticas recomendadas de armónicos en sistemas de potencia."}, {"key": "IEC61000_430", "code": "IEC 61000-4-30", "name": "Medición de calidad de energía (PQ)", "desc": "Métodos de medición de Power Quality (PQ – Calidad de Energía)."}, {"key": "IEC61000_32_312", "code": "IEC 61000-3-2 / -3-12", "name": "Límites de armónicos (equipos)", "desc": "Límites de emisiones armónicas para equipos (según potencia/uso)."}]}, {"category": "Medición y metrología", "items": [{"key": "IEC61869", "code": "IEC 61869", "name": "Transformadores de medida (TC/TP)", "desc": "Serie para transformadores de instrumentos (TC – Transformador de Corriente; TP – Transformador de Potencial)."}, {"key": "IEC62052_62053", "code": "IEC 62052 / IEC 62053", "name": "Medidores de energía", "desc": "Requisitos generales y ensayos de medidores de energía (según parte)."}, {"key": "IEEEC12", "code": "IEEE C12", "name": "Medición (serie)", "desc": "Serie para medidores, comunicación y requerimientos (USA)."}, {"key": "ISOIEC17025", "code": "ISO/IEC 17025", "name": "Laboratorios de ensayo/calibración", "desc": "Competencia técnica y sistema de gestión de laboratorios de ensayo/calibración."}]}, {"category": "Atmósferas explosivas (Ex)", "items": [{"key": "IEC60079", "code": "IEC 60079", "name": "Atmósferas explosivas", "desc": "Serie para selección/instalación/ensayos de equipos Ex (atmósferas explosivas)."}, {"key": "IECEx", "code": "IECEx", "name": "Esquema IECEx de certificación", "desc": "Certificación internacional basada en IEC 60079."}, {"key": "ATEX", "code": "ATEX (UE)", "name": "Marco regulatorio europeo", "desc": "Directivas europeas para equipos/ambientes explosivos (ATEX)."}]}, {"category": "Renovables, almacenamiento y Smart Grid", "items": [{"key": "IEC61400", "code": "IEC 61400", "name": "Aerogeneradores", "desc": "Serie para diseño/ensayos/seguridad de parques eólicos y aerogeneradores."}, {"key": "IEC61727", "code": "IEC 61727", "name": "Interconexión fotovoltaica a red", "desc": "Requisitos para sistemas fotovoltaicos conectados a red."}, {"key": "IEC62109", "code": "IEC 62109", "name": "Seguridad convertidores FV", "desc": "Requisitos de seguridad para convertidores de sistemas fotovoltaicos."}, {"key": "IEEE1547", "code": "IEEE 1547", "name": "Interconexión de recursos distribuidos (DER)", "desc": "Requisitos para interconexión de DER (Distributed Energy Resources) a la red."}, {"key": "IEC62619_62620", "code": "IEC 62619 / IEC 62620", "name": "Baterías industriales", "desc": "Seguridad y desempeño para baterías industriales (según aplicación/química)."}, {"key": "IEEE2030", "code": "IEEE 2030", "name": "Interoperabilidad Smart Grid", "desc": "Marco/guías de interoperabilidad para redes inteligentes (familia)."}]}, {"category": "Carga de vehículos eléctricos (EV)", "items": [{"key": "IEC61851", "code": "IEC 61851", "name": "Sistema de carga conductiva", "desc": "Requisitos para EVSE (Electric Vehicle Supply Equipment – Equipo de Suministro para Vehículos Eléctricos) y modos de carga."}, {"key": "IEC62196", "code": "IEC 62196", "name": "Conectores/enchufes de carga", "desc": "Dimensiones, tipos y requisitos de conectores para carga."}, {"key": "ISO15118", "code": "ISO 15118", "name": "Comunicación vehículo-red (V2G)", "desc": "Comunicación V2G (Vehicle-to-Grid – Vehículo a Red) y Plug & Charge."}, {"key": "IEC63110", "code": "IEC 63110", "name": "Gestión backend de carga", "desc": "Comunicación y gestión de infraestructura de carga (backend)."}]}, {"category": "Gestión de calidad (QA/QC)", "items": [{"key": "ISO9001", "code": "ISO 9001", "name": "Sistema de gestión de calidad", "desc": "QMS (Quality Management System – Sistema de Gestión de Calidad): control documental, proveedores, control de producción, liberación, no conformidades."}, {"key": "ISO10005", "code": "ISO 10005", "name": "Planes de calidad", "desc": "Guía para estructurar planes de calidad por proyecto."}, {"key": "ISO19011", "code": "ISO 19011", "name": "Auditorías de sistemas de gestión", "desc": "Guía para auditar sistemas de gestión (calidad, ambiental, SST, etc.)."}, {"key": "ISO14001", "code": "ISO 14001", "name": "Gestión ambiental", "desc": "Sistema de gestión ambiental (SGA)."}]}], "items": [{"key": "IEC", "code": "IEC", "name": "International Electrotechnical Commission", "desc": "Organismo internacional que publica normas eléctricas/electrónicas. Base en potencia, instalaciones, equipos, cables, compatibilidad electromagnética (EMC).", "category": "Organismos y marcos", "tags": ["IEC"]}, {"key": "IEEE", "code": "IEEE", "name": "Institute of Electrical and Electronics Engineers", "desc": "Estándares técnicos (potencia, protección, comunicaciones, cálculo, interoperabilidad). Muy usado en América.", "category": "Organismos y marcos", "tags": ["IEEE"]}, {"key": "ISOIEC", "code": "ISO/IEC", "name": "ISO + ISO/IEC", "desc": "Gestión, calidad, seguridad, laboratorios, etc. Cuando es conjunto ISO/IEC aplica fuerte en tecnologías de la información (TI).", "category": "Organismos y marcos", "tags": ["ISO", "IEC"]}, {"key": "NFPA", "code": "NFPA", "name": "National Fire Protection Association", "desc": "Normas de seguridad y protección contra incendios. NFPA 70 (NEC) y NFPA 70E son claves.", "category": "Organismos y marcos", "tags": ["NFPA"]}, {"key": "ULCSA", "code": "UL / CSA", "name": "UL / CSA", "desc": "Normas/certificación de producto (especialmente mercado USA/Canadá).", "category": "Organismos y marcos", "tags": ["UL", "CSA"]}, {"key": "ANSI", "code": "ANSI", "name": "American National Standards Institute", "desc": "Marco de normalización USA; coordina estándares (muchos son IEEE/UL/otros).", "category": "Organismos y marcos", "tags": ["ANSI"]}, {"key": "CENELEC", "code": "CENELEC EN", "name": "Normas europeas EN", "desc": "Armonización europea; muchas se basan en IEC con adopciones EN.", "category": "Organismos y marcos", "tags": ["CENELEC", "EN"]}, {"key": "ITUETSI", "code": "ITU / ETSI", "name": "Telecom y comunicaciones", "desc": "Normas de telecomunicaciones (más TI/telecom que potencia).", "category": "Organismos y marcos", "tags": ["ITU", "ETSI"]}, {"key": "NEMA", "code": "NEMA", "name": "National Electrical Manufacturers Association", "desc": "Estándares de producto (closures, tableros). Muy usado con mercado USA.", "category": "Organismos y marcos", "tags": ["NEMA"]}, {"key": "IEC60364", "code": "IEC 60364", "name": "Instalaciones eléctricas de baja tensión (BT)", "desc": "Diseño/ejecución/seguridad de instalaciones de baja tensión (BT – Baja Tensión).", "category": "Instalaciones y tableros BT", "tags": ["IEC", "60364"]}, {"key": "NFPA70", "code": "NFPA 70 (NEC)", "name": "National Electrical Code (NEC – Código Eléctrico Nacional)", "desc": "Código de instalaciones eléctricas USA (requisitos constructivos/seguridad).", "category": "Instalaciones y tableros BT", "tags": ["NFPA", "NEC"]}, {"key": "IEC60204", "code": "IEC 60204-1", "name": "Equipos eléctricos de máquinas", "desc": "Seguridad eléctrica en maquinaria industrial: diseño/ensayos del equipo eléctrico de máquinas.", "category": "Instalaciones y tableros BT", "tags": ["IEC", "60204"]}, {"key": "IEC61439", "code": "IEC 61439", "name": "Tableros BT (conjuntos de aparamenta)", "desc": "Requisitos de diseño/ensayos para tableros BT (switchboards, centros de control de motores – CCM).", "category": "Instalaciones y tableros BT", "tags": ["IEC", "61439"]}, {"key": "IEC60947", "code": "IEC 60947", "name": "Aparamenta BT", "desc": "Interruptores, contactores, protecciones y accesorios (familia).", "category": "Instalaciones y tableros BT", "tags": ["IEC", "60947"]}, {"key": "IEC60529", "code": "IEC 60529", "name": "Grados de protección IP", "desc": "Clasificación IP (Ingress Protection – Protección contra ingreso): polvo/agua.", "category": "Instalaciones y tableros BT", "tags": ["IEC", "60529"]}, {"key": "IEC60664", "code": "IEC 60664", "name": "Coordinación de aislamiento", "desc": "Distancias en aire/superficie (clearance/creepage) y selección frente a sobretensiones.", "category": "Instalaciones y tableros BT", "tags": ["IEC", "60664"]}, {"key": "NFPA70E", "code": "NFPA 70E", "name": "Seguridad eléctrica en el trabajo", "desc": "Arc flash (arco eléctrico), EPP (Equipo de Protección Personal), límites de aproximación y prácticas seguras.", "category": "Seguridad eléctrica (personas)", "tags": ["NFPA"]}, {"key": "IEEE1584", "code": "IEEE 1584", "name": "Cálculo de energía incidente por arco", "desc": "Método para estimar energía incidente (incident energy) y límites de arco eléctrico.", "category": "Seguridad eléctrica (personas)", "tags": ["IEEE", "1584"]}, {"key": "IEC61482", "code": "IEC 61482", "name": "Ropa de protección contra arco eléctrico", "desc": "Ensayos/criterios para vestimenta y EPP frente a arco eléctrico.", "category": "Seguridad eléctrica (personas)", "tags": ["IEC", "61482"]}, {"key": "IEC50110", "code": "IEC 50110-1", "name": "Operación de instalaciones eléctricas", "desc": "Requisitos para operación/maniobras, procedimientos, roles y seguridad en operación.", "category": "Seguridad eléctrica (personas)", "tags": ["IEC", "50110"]}, {"key": "ISO45001", "code": "ISO 45001", "name": "Gestión de seguridad y salud ocupacional (SST)", "desc": "Sistema de gestión de Seguridad y Salud en el Trabajo (SST). Aplica a procesos/SGI.", "category": "Seguridad eléctrica (personas)", "tags": ["ISO", "45001"]}, {"key": "IEC62271", "code": "IEC 62271", "name": "Aparamenta de alta tensión (AT)", "desc": "Familia para celdas, interruptores, GIS/AIS, ensayos, clasificación y requisitos.", "category": "Equipos MT/AT (subestaciones, celdas, interruptores)", "tags": ["IEC", "62271"]}, {"key": "IEEEC37", "code": "IEEE C37", "name": "Aparamenta MT/AT (familia)", "desc": "Familia C37 (USA): interruptores, control, pruebas, etc.", "category": "Equipos MT/AT (subestaciones, celdas, interruptores)", "tags": ["IEEE"]}, {"key": "IEC60076", "code": "IEC 60076", "name": "Transformadores de potencia", "desc": "Serie para diseño/ensayos/ruido/temperatura/aceites (según parte aplicable).", "category": "Equipos MT/AT (subestaciones, celdas, interruptores)", "tags": ["IEC", "60076"]}, {"key": "IEEEC57", "code": "IEEE C57", "name": "Transformadores (serie)", "desc": "Familia C57 (USA) para transformadores: ratings, ensayos, guías.", "category": "Equipos MT/AT (subestaciones, celdas, interruptores)", "tags": ["IEEE"]}, {"key": "IEC60034", "code": "IEC 60034", "name": "Máquinas eléctricas rotativas", "desc": "Serie para motores y generadores: ratings, ensayos, desempeño y protección.", "category": "Equipos MT/AT (subestaciones, celdas, interruptores)", "tags": ["IEC", "60034"]}, {"key": "IEC60871", "code": "IEC 60871", "name": "Condensadores de potencia / bancos", "desc": "Requisitos y ensayos para condensadores y bancos de condensadores.", "category": "Equipos MT/AT (subestaciones, celdas, interruptores)", "tags": ["IEC", "60871"]}, {"key": "IEC60255", "code": "IEC 60255", "name": "Relés de protección", "desc": "Requisitos/ensayos para relés de protección y equipos asociados.", "category": "Protección, control y automatización", "tags": ["IEC", "60255"]}, {"key": "IEC61850", "code": "IEC 61850", "name": "Automatización de subestaciones", "desc": "Modelos/servicios (GOOSE, MMS), ingeniería SCL y criterios de interoperabilidad.", "category": "Protección, control y automatización", "tags": ["IEC", "61850"]}, {"key": "IEEEC372", "code": "IEEE C37.2", "name": "Números de dispositivos (ANSI device numbers)", "desc": "Device numbers (ANSI) para funciones de protección/control (ej: 52, 87, 50/51, etc.).", "category": "Protección, control y automatización", "tags": ["IEEE"]}, {"key": "IEEEC37118", "code": "IEEE C37.118", "name": "Sincrofasores (PMU)", "desc": "Medición y comunicación de fasores sincronizados (PMU – Phasor Measurement Unit).", "category": "Protección, control y automatización", "tags": ["IEEE", "118"]}, {"key": "IEEE1815", "code": "IEEE 1815 (DNP3)", "name": "Protocolo DNP3", "desc": "Protocolo SCADA para telecontrol (DNP3 – Distributed Network Protocol).", "category": "Protección, control y automatización", "tags": ["IEEE", "1815", "DNP"]}, {"key": "IEC60228", "code": "IEC 60228", "name": "Conductores de cables", "desc": "Clases de conductor y resistencias eléctricas del conductor.", "category": "Cables, conductores y fuego", "tags": ["IEC", "60228"]}, {"key": "IEC60502", "code": "IEC 60502", "name": "Cables de potencia (hasta 30 kV)", "desc": "Requisitos/ensayos de cables con aislamiento extruido (según parte/voltaje).", "category": "Cables, conductores y fuego", "tags": ["IEC", "60502"]}, {"key": "IEC60840_62067", "code": "IEC 60840 / IEC 62067", "name": "Cables extruidos > 30 kV", "desc": "Requisitos y ensayos para cables de MT/AT con aislamiento extruido > 30 kV.", "category": "Cables, conductores y fuego", "tags": ["IEC", "60840", "62067"]}, {"key": "IEC60332", "code": "IEC 60332", "name": "Ensayos de propagación de llama", "desc": "Comportamiento al fuego de cables: propagación de llama (serie).", "category": "Cables, conductores y fuego", "tags": ["IEC", "60332"]}, {"key": "IEC60754", "code": "IEC 60754", "name": "Gases halógenos", "desc": "Acidez/corrosividad de gases de combustión (halógenos).", "category": "Cables, conductores y fuego", "tags": ["IEC", "60754"]}, {"key": "IEC61034", "code": "IEC 61034", "name": "Densidad de humo", "desc": "Ensayo de emisión/densidad de humo en combustión.", "category": "Cables, conductores y fuego", "tags": ["IEC", "61034"]}, {"key": "IEC61000", "code": "IEC 61000", "name": "Compatibilidad electromagnética (EMC)", "desc": "Serie EMC (Electromagnetic Compatibility): emisiones, inmunidad y métodos de prueba.", "category": "Compatibilidad electromagnética (EMC)", "tags": ["IEC", "61000"]}, {"key": "CISPR", "code": "CISPR", "name": "Perturbaciones radioeléctricas", "desc": "Normas CISPR para emisiones/medición en radiofrecuencia.", "category": "Compatibilidad electromagnética (EMC)", "tags": ["CISPR"]}, {"key": "IEC61326", "code": "IEC 61326", "name": "EMC para medición/industrial", "desc": "Requisitos EMC para equipos de medición, control y laboratorio.", "category": "Compatibilidad electromagnética (EMC)", "tags": ["IEC", "61326"]}, {"key": "IEEE519", "code": "IEEE 519", "name": "Armónicos y límites", "desc": "Límites y prácticas recomendadas de armónicos en sistemas de potencia.", "category": "Calidad de energía", "tags": ["IEEE", "519"]}, {"key": "IEC61000_430", "code": "IEC 61000-4-30", "name": "Medición de calidad de energía (PQ)", "desc": "Métodos de medición de Power Quality (PQ – Calidad de Energía).", "category": "Calidad de energía", "tags": ["IEC", "61000"]}, {"key": "IEC61000_32_312", "code": "IEC 61000-3-2 / -3-12", "name": "Límites de armónicos (equipos)", "desc": "Límites de emisiones armónicas para equipos (según potencia/uso).", "category": "Calidad de energía", "tags": ["IEC", "61000"]}, {"key": "IEC61869", "code": "IEC 61869", "name": "Transformadores de medida (TC/TP)", "desc": "Serie para transformadores de instrumentos (TC – Transformador de Corriente; TP – Transformador de Potencial).", "category": "Medición y metrología", "tags": ["IEC", "61869"]}, {"key": "IEC62052_62053", "code": "IEC 62052 / IEC 62053", "name": "Medidores de energía", "desc": "Requisitos generales y ensayos de medidores de energía (según parte).", "category": "Medición y metrología", "tags": ["IEC", "62052", "62053"]}, {"key": "IEEEC12", "code": "IEEE C12", "name": "Medición (serie)", "desc": "Serie para medidores, comunicación y requerimientos (USA).", "category": "Medición y metrología", "tags": ["IEEE"]}, {"key": "ISOIEC17025", "code": "ISO/IEC 17025", "name": "Laboratorios de ensayo/calibración", "desc": "Competencia técnica y sistema de gestión de laboratorios de ensayo/calibración.", "category": "Medición y metrología", "tags": ["ISO", "IEC", "17025"]}, {"key": "IEC60079", "code": "IEC 60079", "name": "Atmósferas explosivas", "desc": "Serie para selección/instalación/ensayos de equipos Ex (atmósferas explosivas).", "category": "Atmósferas explosivas (Ex)", "tags": ["IEC", "60079"]}, {"key": "IECEx", "code": "IECEx", "name": "Esquema IECEx de certificación", "desc": "Certificación internacional basada en IEC 60079.", "category": "Atmósferas explosivas (Ex)", "tags": ["IECE"]}, {"key": "ATEX", "code": "ATEX (UE)", "name": "Marco regulatorio europeo", "desc": "Directivas europeas para equipos/ambientes explosivos (ATEX).", "category": "Atmósferas explosivas (Ex)", "tags": ["ATEX", "UE"]}, {"key": "IEC61400", "code": "IEC 61400", "name": "Aerogeneradores", "desc": "Serie para diseño/ensayos/seguridad de parques eólicos y aerogeneradores.", "category": "Renovables, almacenamiento y Smart Grid", "tags": ["IEC", "61400"]}, {"key": "IEC61727", "code": "IEC 61727", "name": "Interconexión fotovoltaica a red", "desc": "Requisitos para sistemas fotovoltaicos conectados a red.", "category": "Renovables, almacenamiento y Smart Grid", "tags": ["IEC", "61727"]}, {"key": "IEC62109", "code": "IEC 62109", "name": "Seguridad convertidores FV", "desc": "Requisitos de seguridad para convertidores de sistemas fotovoltaicos.", "category": "Renovables, almacenamiento y Smart Grid", "tags": ["IEC", "62109"]}, {"key": "IEEE1547", "code": "IEEE 1547", "name": "Interconexión de recursos distribuidos (DER)", "desc": "Requisitos para interconexión de DER (Distributed Energy Resources) a la red.", "category": "Renovables, almacenamiento y Smart Grid", "tags": ["IEEE", "1547"]}, {"key": "IEC62619_62620", "code": "IEC 62619 / IEC 62620", "name": "Baterías industriales", "desc": "Seguridad y desempeño para baterías industriales (según aplicación/química).", "category": "Renovables, almacenamiento y Smart Grid", "tags": ["IEC", "62619", "62620"]}, {"key": "IEEE2030", "code": "IEEE 2030", "name": "Interoperabilidad Smart Grid", "desc": "Marco/guías de interoperabilidad para redes inteligentes (familia).", "category": "Renovables, almacenamiento y Smart Grid", "tags": ["IEEE", "2030"]}, {"key": "IEC61851", "code": "IEC 61851", "name": "Sistema de carga conductiva", "desc": "Requisitos para EVSE (Electric Vehicle Supply Equipment – Equipo de Suministro para Vehículos Eléctricos) y modos de carga.", "category": "Carga de vehículos eléctricos (EV)", "tags": ["IEC", "61851"]}, {"key": "IEC62196", "code": "IEC 62196", "name": "Conectores/enchufes de carga", "desc": "Dimensiones, tipos y requisitos de conectores para carga.", "category": "Carga de vehículos eléctricos (EV)", "tags": ["IEC", "62196"]}, {"key": "ISO15118", "code": "ISO 15118", "name": "Comunicación vehículo-red (V2G)", "desc": "Comunicación V2G (Vehicle-to-Grid – Vehículo a Red) y Plug & Charge.", "category": "Carga de vehículos eléctricos (EV)", "tags": ["ISO", "15118"]}, {"key": "IEC63110", "code": "IEC 63110", "name": "Gestión backend de carga", "desc": "Comunicación y gestión de infraestructura de carga (backend).", "category": "Carga de vehículos eléctricos (EV)", "tags": ["IEC", "63110"]}, {"key": "ISO9001", "code": "ISO 9001", "name": "Sistema de gestión de calidad", "desc": "QMS (Quality Management System – Sistema de Gestión de Calidad): control documental, proveedores, control de producción, liberación, no conformidades.", "category": "Gestión de calidad (QA/QC)", "tags": ["ISO", "9001"]}, {"key": "ISO10005", "code": "ISO 10005", "name": "Planes de calidad", "desc": "Guía para estructurar planes de calidad por proyecto.", "category": "Gestión de calidad (QA/QC)", "tags": ["ISO", "10005"]}, {"key": "ISO19011", "code": "ISO 19011", "name": "Auditorías de sistemas de gestión", "desc": "Guía para auditar sistemas de gestión (calidad, ambiental, SST, etc.).", "category": "Gestión de calidad (QA/QC)", "tags": ["ISO", "19011"]}, {"key": "ISO14001", "code": "ISO 14001", "name": "Gestión ambiental", "desc": "Sistema de gestión ambiental (SGA).", "category": "Gestión de calidad (QA/QC)", "tags": ["ISO", "14001"]}]};

const $ = (q, el=document) => el.querySelector(q);
const $$ = (q, el=document) => Array.from(el.querySelectorAll(q));

const state = {
  mode: 'all',        // all | cat | fav
  category: null,
  q: '',
  currentItem: null,
};

const LS_KEY = "normas_favs_light_v1";
function getFavs(){
  try{ return JSON.parse(localStorage.getItem(LS_KEY) || "[]"); }catch{ return []; }
}
function setFavs(arr){ localStorage.setItem(LS_KEY, JSON.stringify(arr)); }

function uniq(arr){ return [...new Set(arr)]; }

function escapeHtml(s){
  return (s||"").replaceAll("&","&amp;").replaceAll("<","&lt;").replaceAll(">","&gt;").replaceAll('"',"&quot;");
}

function toast(msg){
  const t = $("#toast");
  $("#toastTxt").textContent = msg || "Listo";
  t.classList.add("show");
  clearTimeout(window.__toastT);
  window.__toastT = setTimeout(()=>t.classList.remove("show"), 1500);
}

function renderCats(){
  const el = $("#catlist");
  el.innerHTML = "";
  DB.categories.forEach((c)=>{
    const d = document.createElement("div");
    d.className = "cat";
    d.dataset.cat = c.category;
    d.innerHTML = `
      <span class="dot"></span>
      <div class="meta">
        <div class="name">${escapeHtml(c.category)}</div>
        <div class="count">${c.items.length} items</div>
      </div>
    `;
    d.addEventListener("click", ()=>{
      state.mode = "cat";
      state.category = c.category;
      $("#search").value = "";
      state.q = "";
      render();
    });
    el.appendChild(d);
  });
}

function renderChips(){
  const chips = $("#chips");
  const tokens = uniq(DB.items.flatMap(x => x.tags || [])).slice(0, 22);
  chips.innerHTML = tokens.map(t => `<div class="chip" data-t="${escapeHtml(t)}">${escapeHtml(t)}</div>`).join("");
  $$(".chip", chips).forEach(ch=>{
    ch.addEventListener("click", ()=>{
      $("#search").value = ch.dataset.t;
      state.q = ch.dataset.t;
      state.mode = "all";
      state.category = null;
      render();
    });
  });
}

function matches(item, q){
  if(!q) return true;
  const t = (item.code + " " + item.name + " " + item.desc + " " + item.category + " " + (item.tags||[]).join(" ")).toLowerCase();
  return t.includes(q.toLowerCase());
}

function getViewItems(){
  let items = DB.items;

  if(state.mode === "cat" && state.category){
    items = items.filter(x => x.category === state.category);
  }else if(state.mode === "fav"){
    const favs = new Set(getFavs());
    items = items.filter(x => favs.has(x.key));
  }

  if(state.q) items = items.filter(x => matches(x, state.q));
  return items;
}

function setActiveCat(){
  $$(".cat").forEach(x => x.classList.remove("active"));
  if(state.mode === "cat" && state.category){
    const el = document.querySelector(`.cat[data-cat="${CSS.escape(state.category)}"]`);
    if(el) el.classList.add("active");
  }
}

function render(){
  setActiveCat();

  const items = getViewItems();
  const grid = $("#grid");
  grid.innerHTML = "";

  const title = $("#viewTitle");
  const sub = $("#viewSub");

  if(state.mode === "fav"){
    title.textContent = "Favoritos";
    sub.textContent = "Tus normas guardadas localmente en este navegador (localStorage).";
  }else if(state.mode === "cat" && state.category){
    title.textContent = state.category;
    sub.textContent = "Click en una tarjeta para abrir la ventana. Click derecho para el menú.";
  }else{
    title.textContent = "Todo";
    sub.textContent = "Mapa base por familias. Para informe: cita edición/parte exacta de la norma aplicable.";
  }

  if(!items.length){
    grid.innerHTML = `<div class="empty">
      No pillé nada con ese filtro. Prueba con el código (ej: 61439 / 60076) o una palabra (trafo, cables, arc flash).
    </div>`;
    return;
  }

  items.forEach(item=>{
    const card = document.createElement("div");
    card.className = "card";
    const tagsHtml = (item.tags || []).slice(0,4).map(t => `<span class="tag">${escapeHtml(t)}</span>`).join("");
    card.innerHTML = `
      <div class="code">${escapeHtml(item.code)}</div>
      <div class="name">${escapeHtml(item.name)}</div>
      <div class="desc">${escapeHtml(item.desc)}</div>
      <div class="tagrow">${tagsHtml}</div>
    `;
    card.addEventListener("click", ()=> openModal(item));
    card.addEventListener("contextmenu", (e)=>{ e.preventDefault(); openCtx(e.clientX, e.clientY, item); });
    grid.appendChild(card);
  });
}

function openModal(item){
  state.currentItem = item;
  $("#mCode").textContent = item.code;
  $("#mName").textContent = item.name;
  $("#mCat").textContent = item.category;
  $("#mDesc").textContent = item.desc;

  const tags = $("#mTags");
  tags.innerHTML = (item.tags||[]).length
    ? (item.tags||[]).map(t => `<span class="tag">${escapeHtml(t)}</span>`).join("")
    : `<span style="color: var(--muted); font-family: var(--mono);">sin tags</span>`;

  $("#overlay").classList.add("show");
  $("#overlay").setAttribute("aria-hidden","false");
}

function closeModal(){
  $("#overlay").classList.remove("show");
  $("#overlay").setAttribute("aria-hidden","true");
  state.currentItem = null;
}

function copyText(txt){
  if(!txt) return;
  if(navigator.clipboard && navigator.clipboard.writeText){
    navigator.clipboard.writeText(txt).then(()=> toast("Copiado ✅")).catch(()=> toast("No pude copiar 😕"));
  }else{
    toast("Tu navegador no deja copiar");
  }
}

function webSearch(code, name){
  const q = encodeURIComponent(code + " " + name + " standard");
  window.open("https://www.google.com/search?q=" + q, "_blank", "noopener");
}

function toggleFav(key){
  const favs = getFavs();
  const set = new Set(favs);
  if(set.has(key)){ set.delete(key); toast("Quitado de favoritos"); }
  else { set.add(key); toast("Agregado a favoritos"); }
  setFavs(Array.from(set));
}

// Modal actions
$("#mClose").addEventListener("click", closeModal);
$("#overlay").addEventListener("click", (e)=>{ if(e.target.id === "overlay") closeModal(); });
document.addEventListener("keydown", (e)=>{ if(e.key === "Escape") closeModal(); });

$("#aCopy").addEventListener("click", ()=>{ const it = state.currentItem; if(it) copyText(it.code); });
$("#aSearch").addEventListener("click", ()=>{ const it = state.currentItem; if(it) webSearch(it.code, it.name); });
$("#aFav").addEventListener("click", ()=>{ const it = state.currentItem; if(it) toggleFav(it.key); });

// Sidebar actions
$("#btnFav").addEventListener("click", ()=>{ state.mode="fav"; state.category=null; state.q=$("#search").value.trim(); render(); });
$("#btnAll").addEventListener("click", ()=>{ state.mode="all"; state.category=null; render(); });
$("#btnClearFav").addEventListener("click", ()=>{
  localStorage.removeItem(LS_KEY);
  toast("Favoritos borrados");
  if(state.mode === "fav") render();
});

// Search
$("#search").addEventListener("input", (e)=>{ state.q = e.target.value.trim(); render(); });

// Context menu
const ctx = $("#ctx");
let ctxItem = null;

function openCtx(x, y, item){
  ctxItem = item;
  ctx.style.left = Math.min(x, window.innerWidth - 270) + "px";
  ctx.style.top  = Math.min(y, window.innerHeight - 210) + "px";
  ctx.classList.add("show");
}
function closeCtx(){ ctx.classList.remove("show"); ctxItem = null; }

document.addEventListener("click", (e)=>{ if(!ctx.contains(e.target)) closeCtx(); });
document.addEventListener("scroll", closeCtx, true);
document.addEventListener("keydown", (e)=>{
  if(!ctxItem) return;
  if(e.key === "Enter") openModal(ctxItem);
  if(e.key.toLowerCase() === "s") webSearch(ctxItem.code, ctxItem.name);
  if(e.key.toLowerCase() === "f") toggleFav(ctxItem.key);
  if((e.ctrlKey || e.metaKey) && e.key.toLowerCase() === "c") copyText(ctxItem.code);
});

ctx.addEventListener("click", (e)=>{
  const row = e.target.closest(".item");
  if(!row || !ctxItem) return;
  const act = row.dataset.act;
  if(act === "open") openModal(ctxItem);
  if(act === "copy") copyText(ctxItem.code);
  if(act === "search") webSearch(ctxItem.code, ctxItem.name);
  if(act === "fav") toggleFav(ctxItem.key);
  closeCtx();
});

// init
renderCats();
renderChips();
render();
</script>
</body>
</html>
